<div class="chat-col">
  <div class="panel" style="display:flex;flex-direction:column;gap:8px">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <strong>Chat</strong>
      <span class="small">Modos: 0</span>
    </div>

    <div id="messages" class="messages" aria-live="polite"></div>

    <form id="chatForm" class="chat-form" onsubmit="return false;">
      <input id="nick" type="text" placeholder="Pseudo" value="Anonyme" maxlength="24" />
      <input id="msg" type="text" placeholder="Message..." />
      <button id="sendBtn">Envoyer</button>
    </form>

    <div class="rules panel" style="background:transparent;border-color:rgba(255,255,255,0.04)">
      <div style="font-weight:700;margin-bottom:6px">Règlement</div>
      <ol>
        <li>Pas d'insultes (mots remplacés par des étoiles)</li>
        <li>10s entre chaque message</li>
        <li>Respectez les autres</li>
      </ol>
    </div>
  </div>
</div>

<script>
// DOM
const messagesEl = document.getElementById('messages');
const sendBtn = document.getElementById('sendBtn');
const msgInput = document.getElementById('msg');
const nickInput = document.getElementById('nick');

// Fonction pour échapper HTML
function escapeHtml(s){
  return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"})[c]);
}

// Fonction pour ajouter un message dans la chat box
function addMessage(nick, text){
  const div = document.createElement('div');
  div.className = 'msg';
  div.innerHTML = '<div class="nick">'+escapeHtml(nick)+'</div><div class="text">'+escapeHtml(text)+'</div>';
  messagesEl.appendChild(div);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

// Gestion du clic sur "Envoyer"
sendBtn.addEventListener('click', () => {
  const nick = (nickInput.value||'').trim() || 'Anonyme';
  const text = (msgInput.value||'').trim();
  if (!text) return;
  addMessage(nick, text);
  msgInput.value = '';
  msgInput.focus();
});

// Envoi avec touche Entrée
msgInput.addEventListener('keypress', e => {
  if (e.key === 'Enter') {
    e.preventDefault();
    sendBtn.click();
  }
});
</script>






